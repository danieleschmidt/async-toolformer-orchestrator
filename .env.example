# Async Toolformer Orchestrator Configuration
# Copy this file to .env and configure with your values

# ========================================
# LLM Provider Configuration
# ========================================

# OpenAI Configuration
OPENAI_API_KEY=your-openai-api-key-here
OPENAI_ORG_ID=your-org-id-here  # Optional
OPENAI_BASE_URL=https://api.openai.com/v1  # Optional custom endpoint
OPENAI_DEFAULT_MODEL=gpt-4o
OPENAI_SPECULATION_MODEL=gpt-3.5-turbo

# Anthropic Configuration
ANTHROPIC_API_KEY=your-anthropic-api-key-here
ANTHROPIC_DEFAULT_MODEL=claude-3-opus-20240229

# Default LLM Provider (openai, anthropic, mock)
DEFAULT_LLM_PROVIDER=openai

# ========================================
# Rate Limiting Configuration
# ========================================

# Global rate limits
GLOBAL_MAX_REQUESTS_PER_SECOND=100
GLOBAL_MAX_TOKENS_PER_MINUTE=150000

# Per-service rate limits (JSON format)
RATE_LIMITS_CONFIG={"openai": {"calls": 50, "tokens": 150000}, "anthropic": {"calls": 100}, "google": {"calls": 100}}

# ========================================
# Redis Configuration (for distributed rate limiting)
# ========================================

REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=  # Leave empty if no password
REDIS_DB=0
REDIS_SSL=false
REDIS_CLUSTER_MODE=false

# ========================================
# Performance Configuration
# ========================================

# Parallelism settings
MAX_PARALLEL_TOOLS=30
MAX_PARALLEL_PER_TYPE=10
MAX_SPECULATION_CONCURRENT=5

# Timeouts (in milliseconds)
TOOL_TIMEOUT_MS=10000
LLM_TIMEOUT_MS=30000
TOTAL_TIMEOUT_MS=60000

# Memory management
MAX_MEMORY_GB=8.0
GC_THRESHOLD_GB=6.0
COMPRESS_RESULTS=true
SWAP_TO_DISK=true
DISK_SWAP_PATH=/tmp/orchestrator_swap

# ========================================
# Speculation Engine
# ========================================

ENABLE_SPECULATION=true
SPECULATION_CONFIDENCE_THRESHOLD=0.8
SPECULATION_CACHE_TTL_SECONDS=300
MAX_SPECULATIONS=5

# ========================================
# Branch Management
# ========================================

BRANCH_TIMEOUT_MS=5000
CANCEL_ON_BETTER_RESULT=true
KEEP_TOP_N_BRANCHES=3
CANCEL_SLOW_BRANCHES_AFTER_MS=2000
BRANCH_SCORE_THRESHOLD=0.8

# ========================================
# Monitoring & Observability
# ========================================

# Metrics
ENABLE_METRICS=true
METRICS_PORT=9090
METRICS_PATH=/metrics

# Tracing
ENABLE_TRACING=false
JAEGER_HOST=localhost
JAEGER_PORT=6831
TRACE_SAMPLING_RATE=0.1

# Logging
LOG_LEVEL=INFO  # DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_FORMAT=json  # json, text
LOG_FILE=  # Optional log file path
STRUCTURED_LOGGING=true

# ========================================
# Security Configuration
# ========================================

# API Security
ENABLE_API_KEY_ROTATION=false
API_KEY_ROTATION_DAYS=30
ENCRYPT_SENSITIVE_DATA=true

# Tool execution security
SANDBOX_TOOL_EXECUTION=false
MAX_TOOL_EXECUTION_DEPTH=10
ALLOWED_TOOL_NAMESPACES=async_toolformer,user_tools

# ========================================
# Development Settings
# ========================================

# Debug mode
DEBUG=false
DEVELOPMENT_MODE=false

# Testing
USE_MOCK_LLM=false
MOCK_TOOL_LATENCY_MS=100
ENABLE_TEST_ENDPOINTS=false

# Hot reload
ENABLE_HOT_RELOAD=false
WATCH_DIRECTORIES=src,tests

# ========================================
# Database Configuration (for result persistence)
# ========================================

# PostgreSQL (optional)
DATABASE_URL=postgresql://user:password@localhost:5432/orchestrator
DATABASE_POOL_SIZE=20
DATABASE_MAX_OVERFLOW=40
DATABASE_POOL_TIMEOUT=30

# MongoDB (optional)
MONGODB_URI=mongodb://localhost:27017/orchestrator
MONGODB_DATABASE=orchestrator
MONGODB_COLLECTION=results

# ========================================
# External Service Integration
# ========================================

# Slack notifications (optional)
SLACK_WEBHOOK_URL=
SLACK_CHANNEL=#orchestrator-alerts
ENABLE_SLACK_NOTIFICATIONS=false

# Email notifications (optional)
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USERNAME=
SMTP_PASSWORD=
SMTP_FROM_EMAIL=orchestrator@example.com
ENABLE_EMAIL_NOTIFICATIONS=false

# GitHub integration (optional)
GITHUB_TOKEN=
GITHUB_ORG=
ENABLE_GITHUB_INTEGRATION=false

# ========================================
# Feature Flags
# ========================================

FEATURE_SPECULATION_ENGINE=true
FEATURE_BRANCH_CANCELLATION=true
FEATURE_MEMORY_COMPRESSION=true
FEATURE_DISK_SWAP=true
FEATURE_DISTRIBUTED_RATE_LIMITING=false
FEATURE_TOOL_CHAINS=true
FEATURE_RESULT_STREAMING=true
FEATURE_ADAPTIVE_TIMEOUTS=false

# ========================================
# Deployment Configuration
# ========================================

# Environment
ENVIRONMENT=development  # development, staging, production
DEPLOYMENT_REGION=us-east-1
INSTANCE_ID=  # Auto-generated if not provided

# Health checks
HEALTH_CHECK_INTERVAL_SECONDS=30
HEALTH_CHECK_TIMEOUT_SECONDS=5
ENABLE_READINESS_PROBE=true
ENABLE_LIVENESS_PROBE=true